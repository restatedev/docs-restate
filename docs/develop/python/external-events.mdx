---
title: "External Events"
description: "Handle external events and human-in-the-loop patterns with durable waiting primitives."
icon: "hourglass-start"
---

import AwakeablesIntro from "/snippets/sdk/awakeables-intro.mdx";
import AwakeablesOutro from "/snippets/sdk/awakeables-outro.mdx";

<AwakeablesIntro/>

### Creating and waiting for awakeables
1. **Create an awakeable** - Get a unique ID and promise
2. **Send the ID externally** - Pass the awakeable ID to your external system
3. **Wait for result** - Your handler [suspends](/foundations/key-concepts#suspensions-on-faas) until the external system responds

```py {"CODE_LOAD::python/src/develop/awakeables.py#here"} 
id, promise = ctx.awakeable(type_hint=str)

await ctx.run("trigger task", request_human_review, args=(name, id))

review = await promise
```

<Accordion title="Serialization">
    By default, the SDK serializes the journal entry with the [`json`](https://docs.python.org/3/library/json.html#) library.
    Alternatively, you can specify a [Pydantic model](/develop/python/serialization#pydantic) or [custom serializer](/develop/python/serialization#custom-serialization).
</Accordion>

<Info>
    Note that if you wait for an awakeable in an [exclusive handler](/foundations/functions#handler-behavior) in a Virtual Object, all other calls to this object will be queued.
</Info>

### Resolving/rejecting Awakeables

External processes complete awakeables in two ways:

- **Resolve** with success data → handler continues normally
- **Reject** with error reason → throws a [terminal error](/develop/python/error-handling) in the waiting handler

#### Via HTTP API

External systems can complete awakeables using Restate's HTTP API:

**Resolve with data:**
```shell
curl localhost:8080/restate/awakeables/sign_1PePOqp/resolve \
  --json '"Looks good!"'
```

**Reject with error:**
```shell
curl localhost:8080/restate/awakeables/sign_1PePOqp/reject \
  -H 'content-type: text/plain' \
  -d 'Review rejected: insufficient documentation'
```

#### Via SDK (from other handlers)

**Resolve:**
```python {"CODE_LOAD::python/src/develop/awakeables.py#resolve"} 
ctx.resolve_awakeable(name, review)
```

**Reject:**
```python {"CODE_LOAD::python/src/develop/awakeables.py#reject"} 
ctx.reject_awakeable(name, "Cannot be reviewed")
```

## Durable Promises

**Best for:** Workflows where you need to signal between different workflow handlers.

**Key differences from awakeables:**
- No ID management - use logical names instead
- Scoped to workflow execution lifetime

Use this for:
- Sending data to the run handler
- Have handlers wait for events emitted by the run handler

<Info>
After a workflow's run handler completes, other handlers can still be called for up to 24 hours (default).
The results of resolved Durable Promises remain available during this time.
Update the retention time via the [service configuration](/operate/configuration/services).
</Info>

### Creating and waiting for promises

Wait for a promise by name:

```py {"CODE_LOAD::python/src/develop/durable_promise.py#promise"} 
review = await ctx.promise("review").value()
```

### Resolving/rejecting promises

Resolve/reject from any workflow handler:
```py {"CODE_LOAD::python/src/develop/durable_promise.py#resolve_promise"} 
await ctx.promise("review").resolve(review)
```

### Complete workflow example

```py expandable {"CODE_LOAD::python/src/develop/durable_promise.py#review"} 
review_workflow = restate.Workflow("ReviewWorkflow")


@review_workflow.main()
async def run(ctx: restate.WorkflowContext, document_id: str):
    # Send document for review
    await ctx.run_typed("ask review", ask_review, document_id=document_id)

    # Wait for external review submission
    review = await ctx.promise("review").value()

    # Process the review result
    return process_review(document_id, review)


@review_workflow.handler()
async def submit_review(ctx: restate.WorkflowSharedContext, review: str):
    # Signal the waiting run handler
    await ctx.promise("review").resolve(review)


app = restate.app([review_workflow])
```

<AwakeablesOutro/>