---
title: "State"
description: "Store key-value state in Restate."
icon: "database"
---

Restate lets you persist key-value (K/V) state using its embedded K/V store.

<Info>
    [Learn about Restate's embedded K/V store](/basics/key-concepts#consistent-state).
</Info>


## Key characteristics

**State is only available for Virtual Objects and Workflows.**

Scope & retention: 
- For Virtual Objects: State is scoped per object key and retained indefinitely. It is persisted and shared across all invocations for that object until explicitly cleared.
- For Workflows: State is scoped per workflow execution (workflow ID) and retained only for the duration of the workflowâ€™s configured retention time.

Access Rules:
- [Exclusive handlers](/develop/ts/overview#exclusive-vs-shared-handlers) (e.g., `run()` in workflows) can read and write state.
- [Shared handlers](/develop/ts/overview#exclusive-vs-shared-handlers) can only read state and cannot mutate it.

You can inspect and edit the K/V state via the UI and the [CLI](/operate/introspection#inspecting-application-state).


## List all state keys
Use [`ctx.stateKeys()`](https://docs.restate.dev/tsdocs/interfaces/_restatedev_restate-sdk.ObjectContext#statekeys) to retrieve all keys for which the current Virtual Object has stored state:

```typescript {"CODE_LOAD::ts/src/develop/state.ts#statekeys"} 
const stateKeys = ctx.stateKeys();
```

## Get state value
Use [`ctx.get<T>()`](https://docs.restate.dev/tsdocs/interfaces/_restatedev_restate-sdk.ObjectContext#get-1) to read a value by key. Returns null if the key doesn't exist.

```typescript {"CODE_LOAD::ts/src/develop/state.ts#get"} 
const myString = (await ctx.get<string>("my-string-key")) ?? "my-default";
const myNumber = (await ctx.get<number>("my-number-key")) ?? 0;
```

By default, results are serialized using [JSON](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON). See the [serialization docs](/develop/ts/serialization) to customize this.

## Set state value
Use [`ctx.set()`](https://docs.restate.dev/tsdocs/interfaces/_restatedev_restate-sdk.ObjectContext#set-1) to write or update a value:

```typescript {"CODE_LOAD::ts/src/develop/state.ts#set"} 
ctx.set("my-key", "my-new-value");
```

## Clear state key
Use [`ctx.clear()`](https://docs.restate.dev/tsdocs/interfaces/_restatedev_restate-sdk.ObjectContext#clear) to delete a specific key:

```typescript {"CODE_LOAD::ts/src/develop/state.ts#clear"} 
ctx.clear("my-key");
```

## Clear all state keys

Use [`ctx.clearAll()`](https://docs.restate.dev/tsdocs/interfaces/_restatedev_restate-sdk.ObjectContext#clearall) to remove all stored state for the current Virtual Object:

```typescript {"CODE_LOAD::ts/src/develop/state.ts#clear_all"} 
ctx.clearAll();
```

## Advanced: Eager vs. lazy state loading

By default, Restate eagerly sends the state of a Virtual Object or Workflow when invoking a handler. This means the state is attached to the request and available immediately when the handler starts executing.
All reads and writes to state are local to the handler execution.

Restate also supports lazy state loading, where the state is not sent with the request. Instead, the handler can access the state via `ctx.get()` calls, which will fetch that key-value pair from the Restate Server on demand.
To enable lazy loading, set the `enableLazyState` option to `true` in the [service or handler configuration](/operate/configuration/services).

