---
title: "Vercel"
description: "Run your TypeScript services on Vercel"
---

import CustomVars from "/snippets/custom-variables.mdx";

This page describes how to set up a Restate + Vercel service, starting from the [template](https://github.com/restatedev/vercel-template).

<Card
    title="Create your Restate + Vercel GitHub repository"
    icon="github"
    href="https://github.com/new?template_name=vercel-template&template_owner=restatedev"
    arrow="true"
    horizontal
/>

## Serving the Restate SDK using Next.js

To serve the Restate SDK, create a `fetch` endpoint:

```typescript {"CODE_LOAD::https://raw.githubusercontent.com/restatedev/examples/refs/heads/main/typescript/templates/vercel/src/restate/serve.ts"} 
import * as restate from "@restatedev/restate-sdk/fetch";
import { greeter } from "@/restate/greeter";

// Create the Restate endpoint. 
// Here you need to register your services
const endpoint = restate.createEndpointHandler({ services: [greeter] });

// Adapt it to Next.js route handlers
export const serve = () => {
  return {
    POST: (req: Request) => endpoint(req),
    GET: (req: Request) => endpoint(req),
  };
};
```

And expose it in a Next.js parametrized route, e.g. `/restate/[[...services]]`:

```typescript {"CODE_LOAD::https://raw.githubusercontent.com/restatedev/examples/refs/heads/main/typescript/templates/vercel/src/app/restate/%5B%5B...services%5D%5D/route.ts"} 
import { serve } from "@/restate/serve";

// This is the route that exposes the Restate services.
// You can register it to Restate using /restate subpath (check the README)
// To call it, open Restate > Overview > Greeter > Playground
export const { GET, POST } = serve();
```

## Configure Vercel project

With the GitHub repository set up, go over to [the Vercel dashboard](https://vercel.com/new) to create the project.

For Restate to access the Vercel project, you have two alternatives:

* Disable [Vercel Authentication](https://vercel.com/docs/security/deployment-protection/methods-to-protect-deployments/vercel-authentication) for the project, making its URLs publicly accessible.
![Vercel Authentication](/img/services/deploy/vercel-disable-authentication.png)
* Enable [Protection Bypass for Automation](https://vercel.com/docs/deployment-protection/methods-to-bypass-deployment-protection/protection-bypass-automation). This makes the URL accessible only if the `x-vercel-protection-bypass` header is provided with the right value.

## Register the service to Restate

To [register the service](/services/versioning), use the CLI or UI. Make sure to register the [Commit URL](https://vercel.com/docs/deployments/generated-urls#generated-from-git) so that Restate can address specific Vercel deployments:

```shell
npx @restatedev/restate deployments register \
  --use-http1.1 \
  https://<project-name>-<unique-hash>-<scope-slug>.vercel.app/restate
```

<Tip>
    `--use-http1.1` is required to interact with Next.js projects.
</Tip>

If you set up **Protection Bypass for Automation** as described above, pass the additional header as argument:

```shell
npx @restatedev/restate deployments register \
    --use-http1.1 \
    --extra-header x-vercel-protection-bypass=<token> \
    https://<project-name>-<unique-hash>-<scope-slug>.vercel.app/restate
```

You're set up! Head over to the **Overview page > Greeter > Playground** and start sending requests to your service.

## Restate identity keys (for Restate Cloud)

Follow the guide in your Restate Cloud Dashboard to set up Restate identity keys, to make sure only a specific Restate Cloud environment can call it.

<Card
    title="Restate Cloud > Developers > Security"
    icon="lock"
    href="https://cloud.restate.dev/to/developers/integration#http-endpoints"
    arrow="true"
    horizontal
>
    Set up Restate identity keys
</Card>

## CI/CD Automation

The template includes a setup to automatically register a new [Restate Deployment version](/services/versioning) when a Vercel deployment gets promoted.
This is done by the GitHub Action [deploy.yml](https://github.com/restatedev/examples/blob/main/typescript/templates/vercel/.github/workflows/deploy.yml), which reacts to Vercel's [repository dispatch](https://vercel.com/docs/git/vercel-for-github#repository-dispatch-events) events.

To enable automatic registration, add the following to [**GitHub Actions repository secrets**](https://docs.github.com/en/actions/how-tos/write-workflows/choose-what-workflows-do/use-secrets):
- `RESTATE_ADMIN_URL`: The Admin URL. You can find this in Developers > Invoke. For example: `https://some-environment-private-id.env.us.restate.cloud:9070`
- `RESTATE_AUTH_TOKEN`: Your Restate Cloud auth token. To get one, go to [Developers > API Keys > Create API Key](https://cloud.restate.dev?createApiKey=true&createApiKeyDescription=deployment-key&createApiKeyRole=rst:role::AdminAccess), and make sure to select **Admin** for the role

![Token setup](/img/services/deploy/deployment-token.png)

- If you set up the Protection Bypass for Automation as described above, add the secret `VERCEL_PROTECTION_BYPASS_TOKEN` with the token value

<Accordion title={"Self-hosted Restate"}>
    You can use the [deploy.yml](https://github.com/restatedev/examples/blob/main/typescript/templates/vercel/.github/workflows/deploy.yml) with Self-hosted Restate as well,
    just make sure to correctly set up `RESTATE_AUTH_TOKEN` and `RESTATE_ADMIN_URL` to reach your Restate cluster.
</Accordion>
